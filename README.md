# STS 3.0 (MionaRira Edition)

Rust 重构的 STS 摄影表编辑器。此版本在原版极速轻量的基础上，进行了全面的重构升级
## 功能特性

- **快速轻量**：优化后的可执行文件约 3MB，内存占用极小
- **原生 STS 格式**：完整支持读写 `.sts` 文件，支持 Shift-JIS 编码
- **多语言支持 (i18n)**：内置简体中文、英语、日语，支持无缝热切换
- **动态主题引擎**：默认搭载专属主题，并内置深色、浅色等多种预设，支持自定义调色并导出为 JSON
- **进阶智能填充**：支持框选数字进行线性插值补间，支持下拉自动推演序列，且完美避让保留帧（如 `-`）
- **预览器与零空间烘焙 (Bake)**：内置序列帧播放器，支持一键将摄影表时序通过“硬链接”导出为物理序列帧（支持 TGA/TIFF 等），不占用额外硬盘空间
- **无缝对接**：可无缝传输提取 AE 关键帧数据

## 使用方法

### 创建新时间表
1. 点击 **文件 → 新建** 或按 **Ctrl+N**
2. 配置参数（名称、图层数、帧率、每页帧数、时长）
3. 点击 **确定** 创建

### 编辑与智能排表
- **点击** 单元格开始编辑，**Enter** 确认并向下移动
- **空输入** + **Enter** 复制上方单元格的值
- **智能填充**：框选一段带有起始和结束数值的区域，右键点击“智能填充”，自动完成补间

### 导出与管线对接
- **AE 关键帧导出**：选中图层后，右键点击“复制为 AE 关键帧”，直接在 After Effects 中粘贴。
- **烘焙到序列 (Bake)**：打开预览器并绑定文件夹，点击 "Bake" 按钮生成物理序列文件夹。

---

## 文件格式
ShiraheiTimeSheet 二进制格式

支持：
- 最多 **255 个图层**
- 最多 **65535 帧**

### 编码处理
使用 `encoding_rs` 库处理 Shift-JIS 编码：
- 读取时自动解码为 UTF-8
- 保存时转换回 Shift-JIS
- 兼容日文图层名称

## 构建与开发

```bash
# 调试
cargo build

# 发布
cargo build --release
```
发布版本的可执行文件将位于 `target/release/sts.exe`。

### 开发环境设置
```bash
# 克隆仓库
git clone https://github.com/SuzuKaO/sts-rust.git
cd sts-rust

# 运行测试
cargo test

# 启动开发版本
cargo run
```

### 代码风格
- 使用 `rustfmt` 格式化代码
- 使用 `clippy` 检查代码质量
```bash
cargo fmt
cargo clippy
```

## 依赖项与系统要求

- **egui / eframe** 0.29 - GUI 框架与原生窗口包装器
- **encoding_rs** - Shift-JIS 编码/解码
- **rfd** - 原生文件对话框
- **image** - 图像解码（支持 TGA/TIFF）
- **FFmpeg** (可选) - 视频导入功能需在系统环境变量中配置 FFmpeg

**系统要求**：
- Windows 7+ / macOS 10.13+ / 现代 Linux 发行版

## 许可证 & 致谢
Apache-2.0

特别鸣谢原始 ShiraheiTimeSheet 作者以及 egui GUI 框架提供的坚实基础。